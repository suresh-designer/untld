{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/suresh/Documents/Git/untld/lib/color-utils.ts"],"sourcesContent":["/**\n * Utility to extract a color palette from an image URL using the Canvas API.\n */\nexport async function extractPaletteFromImage(imageUrl: string, count: number = 5): Promise<string[]> {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.crossOrigin = \"Anonymous\"; // Crucial for cross-domain images\n\n        img.onload = () => {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            if (!ctx) {\n                resolve([]);\n                return;\n            }\n\n            // Small scale for faster processing\n            const scale = 50;\n            canvas.width = scale;\n            canvas.height = scale;\n\n            ctx.drawImage(img, 0, 0, scale, scale);\n\n            const imageData = ctx.getImageData(0, 0, scale, scale).data;\n            const colorCounts: { [key: string]: number } = {};\n\n            // Sample pixels\n            for (let i = 0; i < imageData.length; i += 4) {\n                const r = imageData[i];\n                const g = imageData[i + 1];\n                const b = imageData[i + 2];\n                const a = imageData[i + 3];\n\n                // Skip transparent or near-transparent pixels\n                if (a < 128) continue;\n\n                // Skip extremely dark or extremely light pixels (often background/noise)\n                const brightness = (r * 299 + g * 587 + b * 114) / 1000;\n                if (brightness < 20 || brightness > 235) continue;\n\n                // Group similar colors by rounding components\n                const factor = 10;\n                const roundedR = Math.round(r / factor) * factor;\n                const roundedG = Math.round(g / factor) * factor;\n                const roundedB = Math.round(b / factor) * factor;\n\n                const hex = rgbToHex(roundedR, roundedG, roundedB);\n                colorCounts[hex] = (colorCounts[hex] || 0) + 1;\n            }\n\n            // Sort by frequency and take top N\n            const palette = Object.entries(colorCounts)\n                .sort((a, b) => b[1] - a[1])\n                .slice(0, count)\n                .map(entry => entry[0]);\n\n            resolve(palette);\n        };\n\n        img.onerror = () => {\n            console.warn('Failed to load image for color extraction:', imageUrl);\n            resolve([]);\n        };\n\n        // Use our proxy to avoid CORS issues with external images\n        img.src = `/api/proxy-image?url=${encodeURIComponent(imageUrl)}`;\n    });\n}\n\nfunction rgbToHex(r: number, g: number, b: number): string {\n    const toHex = (n: number) => {\n        const hex = n.toString(16);\n        return hex.length === 1 ? '0' + hex : hex;\n    };\n    return `#${toHex(r)}${toHex(g)}${toHex(b)}`.toUpperCase();\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,eAAe,wBAAwB,QAAgB,EAAE,QAAgB,CAAC;IAC7E,OAAO,IAAI,QAAQ,CAAC,SAAS;QACzB,MAAM,MAAM,IAAI;QAChB,IAAI,WAAW,GAAG,aAAa,kCAAkC;QAEjE,IAAI,MAAM,GAAG;YACT,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,MAAM,MAAM,OAAO,UAAU,CAAC;YAC9B,IAAI,CAAC,KAAK;gBACN,QAAQ,EAAE;gBACV;YACJ;YAEA,oCAAoC;YACpC,MAAM,QAAQ;YACd,OAAO,KAAK,GAAG;YACf,OAAO,MAAM,GAAG;YAEhB,IAAI,SAAS,CAAC,KAAK,GAAG,GAAG,OAAO;YAEhC,MAAM,YAAY,IAAI,YAAY,CAAC,GAAG,GAAG,OAAO,OAAO,IAAI;YAC3D,MAAM,cAAyC,CAAC;YAEhD,gBAAgB;YAChB,IAAK,IAAI,IAAI,GAAG,IAAI,UAAU,MAAM,EAAE,KAAK,EAAG;gBAC1C,MAAM,IAAI,SAAS,CAAC,EAAE;gBACtB,MAAM,IAAI,SAAS,CAAC,IAAI,EAAE;gBAC1B,MAAM,IAAI,SAAS,CAAC,IAAI,EAAE;gBAC1B,MAAM,IAAI,SAAS,CAAC,IAAI,EAAE;gBAE1B,8CAA8C;gBAC9C,IAAI,IAAI,KAAK;gBAEb,yEAAyE;gBACzE,MAAM,aAAa,CAAC,IAAI,MAAM,IAAI,MAAM,IAAI,GAAG,IAAI;gBACnD,IAAI,aAAa,MAAM,aAAa,KAAK;gBAEzC,8CAA8C;gBAC9C,MAAM,SAAS;gBACf,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,UAAU;gBAC1C,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,UAAU;gBAC1C,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,UAAU;gBAE1C,MAAM,MAAM,SAAS,UAAU,UAAU;gBACzC,WAAW,CAAC,IAAI,GAAG,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC,IAAI;YACjD;YAEA,mCAAmC;YACnC,MAAM,UAAU,OAAO,OAAO,CAAC,aAC1B,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,EAC1B,KAAK,CAAC,GAAG,OACT,GAAG,CAAC,CAAA,QAAS,KAAK,CAAC,EAAE;YAE1B,QAAQ;QACZ;QAEA,IAAI,OAAO,GAAG;YACV,QAAQ,IAAI,CAAC,8CAA8C;YAC3D,QAAQ,EAAE;QACd;QAEA,0DAA0D;QAC1D,IAAI,GAAG,GAAG,CAAC,qBAAqB,EAAE,mBAAmB,WAAW;IACpE;AACJ;AAEA,SAAS,SAAS,CAAS,EAAE,CAAS,EAAE,CAAS;IAC7C,MAAM,QAAQ,CAAC;QACX,MAAM,MAAM,EAAE,QAAQ,CAAC;QACvB,OAAO,IAAI,MAAM,KAAK,IAAI,MAAM,MAAM;IAC1C;IACA,OAAO,CAAC,CAAC,EAAE,MAAM,KAAK,MAAM,KAAK,MAAM,IAAI,CAAC,WAAW;AAC3D"}}]
}